<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>Introduction To Containers - v5.1 - Training Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    .container {
      background: rgba(255, 255, 255, 0.98);
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      border-radius: 20px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .progress-container {
      background: #f1f5f9;
      height: 8px;
      border-radius: 4px;
      margin-bottom: 2rem;
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #10b981, #059669);
      border-radius: 4px;
      transition: width 0.4s ease;
      box-shadow: 0 2px 10px rgba(16, 185, 129, 0.3);
    }
    
    .results-table {
      width: 100%;
      border-collapse: collapse;
      margin: 0 auto;
    }
    
    .quiz-option {
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 16px 20px;
      margin: 8px 0;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      display: block;
      width: 100%;
    }
    
    #options-form {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    .quiz-option:hover {
      border-color: #10b981;
      background: rgba(16, 185, 129, 0.05);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.15);
    }
    
    .quiz-option.selected {
      border-color: #10b981;
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05));
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.2);
    }
    
    .quiz-option input[type="radio"] {
      appearance: none;
      width: 20px;
      height: 20px;
      border: 2px solid #cbd5e1;
      border-radius: 50%;
      margin-right: 12px;
      position: relative;
      transition: all 0.3s ease;
      vertical-align: middle;
    }
    
    .quiz-option input[type="radio"]:checked {
      border-color: #10b981;
      background: #10b981;
    }
    
    .quiz-option input[type="radio"]:checked::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: white;
    }
    
    .results-table th, .results-table td {
      padding: 16px 12px;
      text-align: center;
      border-bottom: 1px solid #e5e7eb;
      vertical-align: middle;
    }
    
    .results-table th {
      background: linear-gradient(135deg, #f8fafc, #f1f5f9);
      font-weight: 600;
      color: #374151;
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .results-table tr:hover {
      background-color: #f9fafb;
    }
    
    .results-table td:first-child {
      text-align: left;
      max-width: 300px;
      word-wrap: break-word;
    }
    
    .correct { 
      color: #059669; 
      font-weight: 600;
      background-color: #d1fae5;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.875rem;
    }
    
    .incorrect { 
      color: #dc2626; 
      font-weight: 600;
      background-color: #fee2e2;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.875rem;
    }
    
    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .container {
        margin: 10px;
        padding: 1.5rem !important;
      }
      
      .quiz-option {
        padding: 12px 16px;
        font-size: 0.95rem;
      }
      
      .results-table th, .results-table td {
        padding: 12px 8px;
        font-size: 0.875rem;
      }
      
      .results-table td:first-child {
        max-width: 200px;
      }
    }
    
    @media print {
      body {
        background: white !important;
        padding: 0;
      }
      .container {
        background: white !important;
        box-shadow: none !important;
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
      }
      #results-container button {
        display: none !important;
      }
      .results-table {
        width: 100% !important;
        border-collapse: collapse !important;
      }
      .results-table th, .results-table td {
        border: 1px solid #ddd !important;
        font-size: 12px !important;
        padding: 8px 4px !important;
      }
    }
  </style>
</head>
<body>
  <div id="quiz-container" class="container p-8 rounded-xl shadow-xl">
    <div class="flex justify-between items-center mb-6">
      <a href="index.html" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 font-medium text-sm">
        ‚Üê Back to Menu
      </a>
      <h1 class="text-3xl font-bold text-gray-800 flex-1 text-center">Introduction To Containers</h1>
      <div class="w-24"></div> <!-- Spacer for centering -->
    </div>
    
    <!-- Mode Selection -->
    <div id="mode-selection" class="mb-6 text-center">
      <p class="text-lg text-gray-600 mb-6">Choose your learning mode:</p>
      <div class="flex flex-col md:flex-row gap-6 justify-center">
        <div id="study-mode-card" class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl border-2 border-blue-200 hover:border-blue-400 transition-all duration-300 cursor-pointer transform hover:scale-105" onclick="selectMode('study')">
          <div class="text-blue-600 mb-4">
            <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold text-blue-800 mb-2">Study Mode</h3>
          <p class="text-blue-700">Learn with immediate feedback, hints, and explanations. Perfect for understanding new concepts.</p>
        </div>
        <div id="quiz-mode-card" class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl border-2 border-green-200 hover:border-green-400 transition-all duration-300 cursor-pointer transform hover:scale-105" onclick="selectMode('quiz')">
          <div class="text-green-600 mb-4">
            <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold text-green-800 mb-2">Quiz Mode</h3>
          <p class="text-green-700">Test your knowledge without hints. Get detailed results at the end to review your performance.</p>
        </div>
      </div>
    </div>
    
    <!-- Quiz Content (initially hidden) -->
    <div id="quiz-content" style="display: none;">
      <!-- Mode Indicator -->
      <div class="flex justify-between items-center mb-4">
        <div id="mode-indicator" class="px-3 py-1 rounded-full text-sm font-medium"></div>
        <div class="flex items-center gap-2">
          <span id="hints-remaining" class="text-sm text-gray-600"></span>
          <button id="reset-mode-btn" class="px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors text-sm">
            Change Mode
          </button>
        </div>
      </div>
    
    <!-- Enhanced Progress Section -->
    <div class="mb-6">
      <!-- Progress Bar -->
      <div class="progress-container">
        <div id="progress-bar" class="progress-bar" style="width: 0%"></div>
      </div>
      
      <!-- Quiz Stats -->
      <div class="flex justify-between items-center mt-3 text-sm text-gray-600">
        <div class="quiz-stats">
          <span id="question-category" class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium"></span>
        </div>
        <div class="score-display">
          Correct: <span id="current-score" class="font-bold text-green-600">0</span> / 
          <span id="total-questions">25</span>
        </div>
      </div>
    </div>
    
    <div id="question-number" class="text-lg text-gray-600 mb-3 text-center font-medium"></div>
    <div id="question-text" class="text-xl mb-6 text-center leading-relaxed text-gray-700 font-medium"></div>
    <form id="options-form"></form>
    
    <!-- Hint System -->
    <div id="hint-section" class="mt-4 text-center" style="display: none;">
      <button id="hint-btn" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors duration-200 font-medium">
        üí° Use Hint
      </button>
      <div id="hint-text" class="mt-2 text-sm text-gray-600 bg-yellow-50 p-3 rounded-lg hidden"></div>
    </div>
    
    <!-- Feedback Section -->
    <div id="feedback" class="mt-6 text-center">
      <div id="answer-feedback" class="mb-4"></div>
      <div id="explanation" class="text-sm text-gray-600 bg-gray-50 p-4 rounded-lg hidden"></div>
    </div>
    
    <div class="flex justify-center gap-4 mt-8">
      <button id="back-btn" class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200 font-medium min-w-[100px] disabled:opacity-50 disabled:cursor-not-allowed">Back</button>
      <button id="show-explanation-btn" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium min-w-[140px] hidden">Show Explanation</button>
      <button id="next-btn" class="px-6 py-3 bg-green-700 text-white rounded-lg hover:bg-green-800 transition-colors duration-200 font-medium min-w-[100px] shadow-lg hover:shadow-xl">Next</button>
    </div>
    </div> <!-- End quiz-content -->
  </div>
  <div id="results-container" class="container p-8 rounded-xl shadow-xl" style="display:none;">
    <div class="flex justify-between items-center mb-6">
      <a href="index.html" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 font-medium text-sm">
        ‚Üê Back to Menu
      </a>
      <h1 class="text-3xl font-bold text-gray-800 flex-1 text-center">Quiz Results</h1>
      <div class="w-24"></div> <!-- Spacer for centering -->
    </div>
    
    <!-- Score Card -->
    <div class="bg-gradient-to-br from-green-50 to-emerald-100 p-6 rounded-xl mb-8 border border-green-200">
      <div class="text-center">
        <p class="text-xl mb-2 text-gray-700 font-medium">Your Final Score</p>
        <p class="text-5xl font-bold text-green-700 mb-2"><span id="final-score"></span>/<span>25</span></p>
        <p class="text-xl text-green-600 font-semibold"><span id="percentage"></span>% Complete</p>
        
        <!-- Performance Grade -->
        <div class="mt-4">
          <div id="performance-grade" class="text-2xl font-bold mb-2"></div>
          <div id="performance-message" class="text-gray-600"></div>
        </div>
      </div>
    </div>
    
    <!-- Category Performance -->
    <div class="mb-6">
      <h3 class="text-lg font-bold mb-4 text-gray-800">Performance by Category</h3>
      <div id="category-performance" class="grid grid-cols-2 md:grid-cols-3 gap-4"></div>
    </div>
    
    <div class="overflow-x-auto">
      <table id="results-table" class="results-table"></table>
    </div>
    <div class="flex justify-center gap-4 mt-8">
      <button id="print-btn" class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200 font-medium min-w-[120px] shadow-lg hover:shadow-xl">üìÑ Print Results</button>
      <button id="review-btn" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium min-w-[120px] shadow-lg hover:shadow-xl">üìö Review Answers</button>
      <button id="restart-btn" class="px-6 py-3 bg-green-700 text-white rounded-lg hover:bg-green-800 transition-colors duration-200 font-medium min-w-[120px] shadow-lg hover:shadow-xl">üîÑ Restart Quiz</button>
    </div>
  </div>
  <script>
    const quizData = [
      { 
        question: "What is a key feature of a general-purpose container?", 
        options: ["It has no rigid roof", "It is totally enclosed and weatherproof", "It is designed for bulk liquids", "It has no side walls"], 
        correct: "It is totally enclosed and weatherproof",
        explanation: "General-purpose containers are fully enclosed structures with rigid walls and roof, providing complete weatherproofing for dry cargo protection.",
        category: "Container Types"
      },
      { 
        question: "Which container type is suitable for loading heavy items from overhead?", 
        options: ["General-purpose Container", "Open-top Container", "Platform Container", "Flat Rack Container"], 
        correct: "Open-top Container",
        explanation: "Open-top containers have removable tops that allow crane loading from above, making them ideal for heavy machinery and oversized cargo.",
        category: "Container Types"
      },
      { 
        question: "What distinguishes a platform container from other container types?", 
        options: ["It has a rigid roof and side walls", "It consists only of a floor structure with corner fittings", "It includes a refrigeration unit", "It has side doors for access"], 
        correct: "It consists only of a floor structure with corner fittings",
        explanation: "Platform containers are essentially flat bases without walls or roof, designed specifically for cargo that exceeds standard container dimensions.",
        category: "Container Types"
      },
      { 
        question: "Which container is reinforced to carry extra-wide cargo?", 
        options: ["Side Door Container", "Flat Rack Container", "Ventilated Container", "Tank Container"], 
        correct: "Flat Rack Container",
        explanation: "Flat Rack containers have collapsible or fixed end walls and are specifically engineered to handle heavy machinery and oversized equipment that requires side loading.",
        category: "Container Types"
      },
      { 
        question: "What is the primary use of a side door container?", 
        options: ["To carry bulk liquids", "To provide easy access when rear doors are inaccessible", "To transport refrigerated goods", "To stack heavy machinery"], 
        correct: "To provide easy access when rear doors are inaccessible",
        explanation: "Side door containers feature additional doors along the side panels, providing access when rear loading is restricted or impractical in tight terminal spaces.",
        category: "Container Features"
      },
      { 
        question: "Which container is designed to prevent condensation for cargo like coffee?", 
        options: ["Ventilated Container", "Dry-Bulk Container", "Refrigerated Container", "Tank Container"], 
        correct: "Ventilated Container",
        explanation: "Ventilated containers have specially designed air circulation slots that prevent moisture buildup and spoilage in organic commodities like coffee and cocoa beans.",
        category: "Specialized Containers"
      },
      { 
        question: "What type of cargo is a tank container designed to carry?", 
        options: ["General cargo", "Bulk liquids and gases", "Heavy machinery", "Extra-wide loads"], 
        correct: "Bulk liquids and gases",
        explanation: "Tank containers are pressure vessels specifically designed for liquid and gaseous cargo, featuring specialized fittings, valves, and safety systems.",
        category: "Specialized Containers"
      },
      { 
        question: "How are dry-bulk containers typically loaded?", 
        options: ["Through side doors", "Through hatchways in the roof", "Through the rear doors", "Through a flexible cover"], 
        correct: "Through hatchways in the roof",
        explanation: "Dry-bulk containers feature specialized discharge systems and reinforced structures to handle loose, granular materials and heavy industrial cargo.",
        category: "Specialized Containers"
      },
      { 
        question: "What feature does a refrigerated container include for temperature control?", 
        options: ["Movable roof-bows", "An integral refrigeration unit", "Ventilation holes", "High loading capacity floor"], 
        correct: "An integral refrigeration unit",
        explanation: "Refrigerated containers have built-in cooling systems with compressors and condensers, maintaining precise temperature control for perishable goods.",
        category: "Temperature-Controlled"
      },
      { 
        question: "Which dangerous goods class includes explosives with a mass explosion hazard?", 
        options: ["Class 2", "Class 1.1", "Class 4.1", "Class 5.1"], 
        correct: "Class 1.1",
        explanation: "Class 1.1 dangerous goods are explosives with a mass explosion hazard, requiring special handling and safety procedures during transport.",
        category: "Dangerous Goods"
      },
      { 
        question: "What does the \"OOG\" attribute indicate in container handling?", 
        options: ["Over-dimension (Out of Gauge)", "Optimal Operating Gear", "Operational Output Grade", "Outward Open Gate"], 
        correct: "Over-dimension (Out of Gauge)",
        explanation: "OOG (Out-of-Gauge) indicates cargo that exceeds standard container dimensions, requiring special handling equipment and operational procedures.",
        category: "Operational Terms"
      },
      { 
        question: "Which container type is best suited for carrying flammable liquids?", 
        options: ["Tank Container", "Open-top Container", "Ventilated Container", "Platform Container"], 
        correct: "Tank Container",
        explanation: "Tank containers are specifically designed for hazardous liquids including flammable substances, with proper safety systems and containment features.",
        category: "Specialized Containers"
      },
      { 
        question: "What is the purpose of the Equipment Code (E-Code) in ISO 6346?", 
        options: ["To identify the container's owner", "To classify the type of container", "To indicate damage status", "To specify handling instructions"], 
        correct: "To classify the type of container",
        explanation: "The E-code in ISO 6346 classifies container types (like dry cargo, tank, refrigerated) ensuring proper handling and equipment matching at terminals.",
        category: "Standards & Codes"
      },
      { 
        question: "Which dangerous goods subclass includes poisonous gases?", 
        options: ["Subclass 2.1", "Subclass 2.2", "Subclass 2.3", "Subclass 3"], 
        correct: "Subclass 2.3",
        explanation: "Subclass 2.3 includes poisonous gases that pose serious health risks and require special handling and safety procedures during transport.",
        category: "Dangerous Goods"
      },
      { 
        question: "What is a key feature of a flat rack container?", 
        options: ["It has a rigid roof", "It has fixed ends and no side walls", "It includes a refrigeration unit", "It has ventilation holes"], 
        correct: "It has fixed ends and no side walls",
        explanation: "Flat rack containers have collapsible or fixed end walls but no side walls, designed for oversized cargo that requires side loading.",
        category: "Container Types"
      },
      { 
        question: "Which container type is used for free-flowing dry cargo like grain?", 
        options: ["Dry-Bulk Container", "General-purpose Container", "Side Door Container", "Tank Container"], 
        correct: "Dry-Bulk Container",
        explanation: "Dry-bulk containers feature specialized discharge systems and reinforced structures to handle loose, granular materials like grain and cement.",
        category: "Specialized Containers"
      },
      { 
        question: "What does the Special Handling Code (SP Code) indicate?", 
        options: ["The container's weight", "Specific handling requirements", "The container's destination", "The type of cargo"], 
        correct: "Specific handling requirements",
        explanation: "SP (Special Provisions) codes mandate specific safety procedures for dangerous goods, including packaging, marking, and handling requirements.",
        category: "Dangerous Goods"
      },
      { 
        question: "Which dangerous goods class includes corrosive substances?", 
        options: ["Class 6", "Class 7", "Class 8", "Class 9"], 
        correct: "Class 8",
        explanation: "Class 8 dangerous goods are corrosive substances that can cause severe damage to living tissue, metals, and other materials.",
        category: "Dangerous Goods"
      },
      { 
        question: "What is the primary benefit of a ventilated container?", 
        options: ["Protection from rain", "Continuous ventilation for cargo", "High payload capacity", "Temperature control"], 
        correct: "Continuous ventilation for cargo",
        explanation: "Ventilated containers provide continuous air circulation to prevent moisture buildup and spoilage in organic commodities.",
        category: "Specialized Containers"
      },
      { 
        question: "Which container type can be equipped with insulation for temperature-sensitive cargo?", 
        options: ["Tank Container", "Platform Container", "Open-top Container", "Flat Rack Container"], 
        correct: "Tank Container",
        explanation: "Tank containers can be equipped with insulation systems for temperature-sensitive liquids requiring thermal protection during transport.",
        category: "Temperature-Controlled"
      },
      { 
        question: "What does the Damage Code indicate in container management?", 
        options: ["The container's age", "The extent of damage", "The loading capacity", "The shipping route"], 
        correct: "The extent of damage",
        explanation: "Damage codes classify the type and severity of container damage, helping determine repair requirements and operational fitness.",
        category: "Container Management"
      },
      { 
        question: "Which dangerous goods subclass includes substances dangerous when wet?", 
        options: ["Subclass 4.1", "Subclass 4.2", "Subclass 4.3", "Subclass 5.1"], 
        correct: "Subclass 4.3",
        explanation: "Subclass 4.3 includes substances that become dangerous when wet, emitting flammable gases upon contact with water.",
        category: "Dangerous Goods"
      },
      { 
        question: "What is the role of the Hold Code in container operations?", 
        options: ["To specify storage location", "To indicate the container's weight", "To classify dangerous goods", "To mark the owner"], 
        correct: "To specify storage location",
        explanation: "Hold codes indicate specific storage requirements and restrictions for containers, particularly for dangerous goods requiring special positioning.",
        category: "Container Management"
      },
      { 
        question: "According to ISO 6346, what does the first character of the container identification code represent?", 
        options: ["The container size", "The owner code", "The equipment category", "The serial number"], 
        correct: "The owner code",
        explanation: "In ISO 6346, the first three characters represent the owner code, identifying the company or organization that owns the container.",
        category: "Standards & Codes"
      },
      { 
        question: "Which UNECE dangerous goods class requires a biohazard symbol?", 
        options: ["Class 6.1", "Class 6.2", "Class 7", "Class 9"], 
        correct: "Class 6.2",
        explanation: "Class 6.2 dangerous goods are infectious substances that require biohazard symbols and special handling procedures to prevent disease transmission.",
        category: "Dangerous Goods"
      }
    ];

    let currentQuestion = 0;
    let answers = [];
    let currentScore = 0;
    let currentMode = 'quiz'; // 'study' or 'quiz'
    let hintsRemaining = 3;
    let hintsUsed = [];

    // Mode selection function - define globally before DOMContentLoaded
    function selectMode(mode) {
      console.log('selectMode called with:', mode);
      try {
        setMode(mode);
        startQuiz();
      } catch (error) {
        console.error('Error in selectMode:', error);
      }
    }

    // Make selectMode globally accessible immediately
    window.selectMode = selectMode;

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function setMode(mode) {
      currentMode = mode;
      const modeIndicator = document.getElementById('mode-indicator');
      const hintsRemainingEl = document.getElementById('hints-remaining');
      const hintSection = document.getElementById('hint-section');
      
      if (mode === 'study') {
        modeIndicator.textContent = 'üìö Study Mode';
        modeIndicator.className = 'px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-700';
        hintsRemainingEl.style.display = 'none';
        hintSection.style.display = 'block'; // Show hints in study mode
      } else {
        modeIndicator.textContent = 'üéØ Quiz Mode';
        modeIndicator.className = 'px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-700';
        hintsRemainingEl.style.display = 'block';
        hintsRemainingEl.textContent = `üí° Hints: ${hintsRemaining}`;
        hintSection.style.display = 'block'; // Show hints in quiz mode
      }
    }

    function generateHint(question) {
      const hints = {
        "What is a key feature of a general-purpose container?": "General-purpose containers are the most common type - they're fully enclosed boxes with solid walls, roof, and doors at one end, designed to protect dry cargo from weather and theft.",
        "Which container type is suitable for loading heavy items from overhead?": "Open-top containers have removable tarpaulin covers instead of solid roofs, allowing cranes to load heavy machinery, steel coils, or oversized equipment from above.",
        "What distinguishes a platform container from other container types?": "Platform containers are basically just a flat deck with corner posts - no walls or roof at all. They're used when cargo is too wide, tall, or oddly shaped to fit in a box.",
        "Which container is reinforced to carry extra-wide cargo?": "Flat rack containers have collapsible or fixed end walls but no side walls or roof. The end walls can often be folded down to accommodate extra-wide loads like construction equipment.",
        "What is the primary use of a side door container?": "Side door containers have additional doors along the side walls. This is useful in tight spaces where trucks can't access the rear doors, or for partial unloading without moving other cargo.",
        "Which container is designed to prevent condensation for cargo like coffee?": "Ventilated containers have passive ventilation holes or vents in the walls that allow air circulation to prevent moisture buildup that could spoil organic products like coffee beans or cocoa.",
        "What type of cargo is a tank container designed to carry?": "Tank containers are essentially large steel tanks built into a container frame. They're specifically designed for liquids and gases - things like chemicals, food-grade liquids, or hazardous materials.",
        "How are dry-bulk containers typically loaded?": "Dry-bulk containers have special hatches in the roof for loading and discharge systems at the bottom. Bulk materials like grain or cement are poured in from above and gravity-fed out below.",
        "What feature does a refrigerated container include for temperature control?": "Refrigerated containers (reefers) have their own built-in refrigeration unit with compressor, condenser, and evaporator - like a giant refrigerator that plugs into ship or terminal power.",
        "Which dangerous goods class includes explosives with a mass explosion hazard?": "Dangerous goods are classified into 9 classes. Class 1 is explosives, and Class 1.1 specifically means explosives that could cause a mass explosion affecting everything in the area.",
        "What does the \"OOG\" attribute indicate in container handling?": "OOG stands for 'Out of Gauge' - meaning the cargo sticks out beyond the standard container dimensions. This requires special handling equipment and careful stowage planning.",
        "Which container type is best suited for carrying flammable liquids?": "Flammable liquids need containment and safety systems. Tank containers are designed for this with pressure relief valves, specialized coatings, and leak-proof construction.",
        "What is the purpose of the Equipment Code (E-Code) in ISO 6346?": "ISO 6346 is the international standard for container markings. The Equipment Code tells you what type of container it is - like 'GP' for general purpose or 'TN' for tank containers.",
        "Which dangerous goods subclass includes poisonous gases?": "Class 2 covers all gases. Subclass 2.1 = flammable gases, 2.2 = non-flammable gases, 2.3 = poisonous/toxic gases that can harm or kill people.",
        "What is a key feature of a flat rack container?": "Flat racks have solid end walls (which may fold down) but completely open sides. This allows side-loading of wide equipment and machinery that won't fit through container doors.",
        "Which container type is used for free-flowing dry cargo like grain?": "Dry-bulk containers are specifically designed for loose, granular materials. They have reinforced floors, special discharge gates, and loading hatches for materials that flow like water.",
        "What does the Special Handling Code (SP Code) indicate?": "SP codes are special provisions for dangerous goods that require specific handling, packaging, or transport conditions beyond the basic dangerous goods class requirements.",
        "Which dangerous goods class includes corrosive substances?": "Class 8 dangerous goods are corrosives - substances that can destroy living tissue or severely damage metals and other materials through chemical action.",
        "What is the primary benefit of a ventilated container?": "Ventilated containers prevent 'container sweat' - condensation that forms when temperature changes cause moisture to collect inside. The vents allow air circulation to prevent spoilage.",
        "Which container type can be equipped with insulation for temperature-sensitive cargo?": "Tank containers can have thermal insulation wrapped around the tank to maintain temperature for products that need to stay warm (like molten sulfur) or cool (but not frozen).",
        "What does the Damage Code indicate in container management?": "Damage codes describe what's wrong with a container and how severe it is - like dents, holes, or structural damage. This determines if it's safe to use and what repairs are needed.",
        "Which dangerous goods subclass includes substances dangerous when wet?": "Subclass 4.3 includes materials that release flammable hydrogen gas when they contact water - like sodium, calcium carbide, or zinc powder.",
        "What is the role of the Hold Code in container operations?": "Hold codes tell you where a container can be safely stowed on a ship - like whether it can go in a cargo hold, must stay on deck, or needs to be segregated from other cargo.",
        "According to ISO 6346, what does the first character of the container identification code represent?": "The first 4 characters of a container number are the owner code - 3 letters identifying the shipping line or leasing company, plus 'U' to show it's a shipping container.",
        "Which UNECE dangerous goods class requires a biohazard symbol?": "Class 6.2 covers infectious substances - materials containing pathogens (bacteria, viruses, etc.) that can cause disease in humans or animals. They need biohazard symbols and special handling."
      };
      
      return hints[question] || "Consider the specific purpose and design features of each container type.";
    }

    function useHint() {
      if (hintsRemaining <= 0 || currentMode === 'study') return;
      
      const currentQ = quizData[currentQuestion];
      const hintText = generateHint(currentQ.question);
      
      document.getElementById('hint-text').textContent = hintText;
      document.getElementById('hint-text').classList.remove('hidden');
      
      hintsRemaining--;
      hintsUsed.push(currentQuestion);
      
      document.getElementById('hints-remaining').textContent = `üí° Hints: ${hintsRemaining}`;
      document.getElementById('hint-btn').disabled = hintsRemaining <= 0;
      
      if (hintsRemaining <= 0) {
        document.getElementById('hint-btn').textContent = 'No Hints Left';
        document.getElementById('hint-btn').classList.add('opacity-50', 'cursor-not-allowed');
      }
    }

    function updateQuestionMeta(question) {
      document.getElementById('question-category').textContent = question.category || 'General';
      
      document.getElementById('current-score').textContent = currentScore;
      document.getElementById('total-questions').textContent = quizData.length;
      
      // Update hint button state
      const hintBtn = document.getElementById('hint-btn');
      const hintText = document.getElementById('hint-text');
      
      if (currentMode === 'quiz') {
        hintBtn.disabled = hintsRemaining <= 0;
        hintText.classList.add('hidden');
      }
    }

    function showFeedback(isCorrect, explanation) {
      const feedbackEl = document.getElementById('answer-feedback');
      const explanationEl = document.getElementById('explanation');
      const showExplanationBtn = document.getElementById('show-explanation-btn');
      
      feedbackEl.innerHTML = isCorrect ? 
        '<div class="text-green-600 font-semibold">‚úì Correct!</div>' :
        '<div class="text-red-600 font-semibold">‚úó Incorrect</div>';
      
      if (explanation) {
        explanationEl.textContent = explanation;
        if (currentMode === 'study') {
          // In study mode, show explanation immediately
          explanationEl.classList.remove('hidden');
          showExplanationBtn.style.display = 'none';
        } else {
          // In quiz mode, show button to reveal explanation
          showExplanationBtn.style.display = 'inline-block';
        }
      }
    }

    function startQuiz() {
      console.log('Starting quiz in mode:', currentMode);
      
      // Hide mode selection, show quiz content
      const modeSelection = document.getElementById('mode-selection');
      const quizContent = document.getElementById('quiz-content');
      
      if (modeSelection && quizContent) {
        modeSelection.style.display = 'none';
        quizContent.style.display = 'block';
        console.log('Mode selection hidden, quiz content shown');
      } else {
        console.error('Mode selection or quiz content elements not found');
        return;
      }
      
      shuffleArray(quizData);
      answers = new Array(quizData.length).fill(null);
      currentQuestion = 0;
      currentScore = 0;
      hintsRemaining = 3;
      hintsUsed = [];
      
      // Reset hint button
      const hintBtn = document.getElementById('hint-btn');
      if (hintBtn) {
        hintBtn.disabled = false;
        hintBtn.textContent = 'üí° Use Hint';
        hintBtn.classList.remove('opacity-50', 'cursor-not-allowed');
      }
      
      showQuestion();
    }

    function resetMode() {
      console.log('Resetting mode - showing mode selection');
      
      // Reset variables
      currentQuestion = 0;
      answers = [];
      currentScore = 0;
      hintsRemaining = 3;
      hintsUsed = [];
      
      // Show mode selection, hide quiz content
      const modeSelection = document.getElementById('mode-selection');
      const quizContent = document.getElementById('quiz-content');
      
      if (modeSelection && quizContent) {
        modeSelection.style.display = 'block';
        quizContent.style.display = 'none';
        console.log('Mode selection shown, quiz content hidden');
      } else {
        console.error('Mode selection or quiz content elements not found');
      }
    }

    function showQuestion() {
      const q = quizData[currentQuestion];
      
      // Update progress bar
      const progressPercentage = ((currentQuestion + 1) / quizData.length) * 100;
      document.getElementById('progress-bar').style.width = progressPercentage + '%';
      
      document.getElementById('question-number').textContent = `Question ${currentQuestion + 1} of ${quizData.length}:`;
      document.getElementById('question-text').textContent = q.question;
      
      // Update question metadata
      updateQuestionMeta(q);
      
      const optionsForm = document.getElementById('options-form');
      optionsForm.innerHTML = '';
      
      q.options.forEach(option => {
        const label = document.createElement('label');
        label.className = 'quiz-option';
        label.style.display = 'block';
        label.style.width = '100%';
        label.innerHTML = `<input type="radio" name="answer" value="${option}"> <span class="text-gray-700 text-lg font-medium">${option}</span>`;
        
        // Add click handler for enhanced interaction
        label.addEventListener('click', function() {
          document.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
          this.classList.add('selected');
          
          // In study mode, show explanation immediately
          if (currentMode === 'study') {
            const selectedValue = this.querySelector('input').value;
            const isCorrect = selectedValue === q.correct;
            
            setTimeout(() => {
              if (isCorrect) {
                document.getElementById('answer-feedback').innerHTML = '<div class="text-green-600 font-medium">‚úì Correct!</div>';
                if (!answers[currentQuestion] || !answers[currentQuestion].isCorrect) {
                  currentScore++;
                  document.getElementById('current-score').textContent = currentScore;
                }
              } else {
                document.getElementById('answer-feedback').innerHTML = '<div class="text-red-600 font-medium">‚úó Incorrect</div>';
              }
              
              // Show explanation immediately in study mode
              document.getElementById('explanation').textContent = q.explanation;
              document.getElementById('explanation').classList.remove('hidden');
            }, 100);
          }
        });
        
        optionsForm.appendChild(label);
      });
      
      // Clear previous feedback
      document.getElementById('answer-feedback').innerHTML = '';
      document.getElementById('explanation').classList.add('hidden');
      document.getElementById('show-explanation-btn').style.display = 'none';
      document.getElementById('hint-text').classList.add('hidden');
      
      // Reset hint button for new question (only if not used for this question)
      if (currentMode === 'quiz' && !hintsUsed.includes(currentQuestion)) {
        const hintBtn = document.getElementById('hint-btn');
        hintBtn.disabled = false;
        hintBtn.textContent = 'üí° Use Hint';
        hintBtn.classList.remove('opacity-50', 'cursor-not-allowed');
      }
      
      // Restore previous selection if exists
      document.querySelectorAll('input[name="answer"]').forEach(input => {
        input.disabled = false;
        if (answers[currentQuestion] && answers[currentQuestion].answer === input.value) {
          input.checked = true;
          input.closest('.quiz-option').classList.add('selected');
          
          // Show previous feedback if available
          if (answers[currentQuestion].feedback) {
            showFeedback(answers[currentQuestion].isCorrect, q.explanation);
          }
        }
      });
      
      document.getElementById('back-btn').disabled = currentQuestion === 0;
      document.getElementById('next-btn').textContent = currentQuestion === quizData.length - 1 ? 'Finish Quiz' : 'Next';
      document.getElementById('next-btn').disabled = false;
    }

    function nextQuestion() {
      const selected = document.querySelector('input[name="answer"]:checked');
      if (!selected && currentQuestion < quizData.length - 1) {
        document.getElementById('answer-feedback').innerHTML = '<div class="text-red-600 font-medium">Please select an answer!</div>';
        return;
      }
      
      if (selected) {
        const isCorrect = selected.value === quizData[currentQuestion].correct;
        
        // Store answer with additional metadata
        answers[currentQuestion] = {
          answer: selected.value,
          isCorrect: isCorrect,
          feedback: true,
          hintUsed: hintsUsed.includes(currentQuestion)
        };
        
        if (isCorrect && currentMode === 'quiz') {
          currentScore++;
          document.getElementById('current-score').textContent = currentScore;
        }
        
        // Show immediate feedback
        showFeedback(isCorrect, quizData[currentQuestion].explanation);
        
        // In study mode, always show explanation immediately
        if (currentMode === 'study') {
          document.getElementById('explanation').classList.remove('hidden');
        }
      }
      
      if (currentQuestion < quizData.length - 1) {
        currentQuestion++;
        showQuestion();
      } else {
        showResults();
      }
    }

    function backQuestion() {
      if (currentQuestion > 0) {
        currentQuestion--;
        showQuestion();
      }
    }

    function showResults() {
      document.getElementById('quiz-container').style.display = 'none';
      document.getElementById('results-container').style.display = 'block';
      
      let score = 0;
      let categoryStats = {};
      
      // Calculate performance statistics
      quizData.forEach((q, index) => {
        const answer = answers[index];
        const isCorrect = answer && answer.isCorrect;
        if (isCorrect) score++;
        
        // Category performance tracking
        const category = q.category || 'General';
        if (!categoryStats[category]) {
          categoryStats[category] = { correct: 0, total: 0 };
        }
        categoryStats[category].total++;
        if (isCorrect) categoryStats[category].correct++;
      });
      
      // Update score display
      const percentage = Math.round((score / quizData.length) * 100);
      document.getElementById('final-score').textContent = score;
      document.getElementById('percentage').textContent = percentage;
      
      // Show performance grade with mode consideration
      const gradeEl = document.getElementById('performance-grade');
      const messageEl = document.getElementById('performance-message');
      
      let modeBonus = currentMode === 'study' ? ' (Study Mode)' : '';
      let hintPenalty = hintsUsed.length > 0 ? ` (${hintsUsed.length} hints used)` : '';
      
      if (percentage >= 90) {
        gradeEl.textContent = 'Excellent! üèÜ' + modeBonus;
        gradeEl.className = 'text-2xl font-bold mb-2 text-green-600';
        messageEl.textContent = 'Outstanding performance! You have mastered container operations.' + hintPenalty;
      } else if (percentage >= 80) {
        gradeEl.textContent = 'Very Good! üéØ' + modeBonus;
        gradeEl.className = 'text-2xl font-bold mb-2 text-blue-600';
        messageEl.textContent = 'Great job! You have a strong understanding of container concepts.' + hintPenalty;
      } else if (percentage >= 70) {
        gradeEl.textContent = 'Good üëç' + modeBonus;
        gradeEl.className = 'text-2xl font-bold mb-2 text-yellow-600';
        messageEl.textContent = 'Good work! Consider reviewing some topics for improvement.' + hintPenalty;
      } else {
        gradeEl.textContent = 'Needs Review üìö' + modeBonus;
        gradeEl.className = 'text-2xl font-bold mb-2 text-red-600';
        messageEl.textContent = 'Additional study recommended. Try Study Mode to learn without pressure.' + hintPenalty;
      }
      
      // Category performance
      const categoryContainer = document.getElementById('category-performance');
      categoryContainer.innerHTML = '';
      Object.entries(categoryStats).forEach(([category, stats]) => {
        const categoryCard = document.createElement('div');
        const categoryPercentage = Math.round((stats.correct / stats.total) * 100);
        categoryCard.className = 'bg-white p-4 rounded-lg border text-center';
        categoryCard.innerHTML = `
          <div class="font-semibold text-gray-800">${category}</div>
          <div class="text-2xl font-bold ${categoryPercentage >= 80 ? 'text-green-600' : categoryPercentage >= 60 ? 'text-yellow-600' : 'text-red-600'}">${stats.correct}/${stats.total}</div>
          <div class="text-sm text-gray-600">${categoryPercentage}%</div>
        `;
        categoryContainer.appendChild(categoryCard);
      });
      
      // Update results table with hint usage
      const table = document.getElementById('results-table');
      let html = '<tr><th>Question</th><th>Category</th><th>Your Answer</th><th>Correct Answer</th><th>Status</th><th>Hints</th></tr>';
      quizData.forEach((q, index) => {
        const answer = answers[index];
        const userAnswer = answer ? answer.answer : 'Not answered';
        const isCorrect = answer ? answer.isCorrect : false;
        const hintUsed = answer && answer.hintUsed ? 'üí°' : '';
        html += `<tr>
          <td>${q.question}</td>
          <td><span class="px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs">${q.category || 'General'}</span></td>
          <td>${userAnswer}</td>
          <td>${q.correct}</td>
          <td class="${isCorrect ? 'correct' : 'incorrect'}">${isCorrect ? 'Correct' : 'Incorrect'}</td>
          <td class="text-center">${hintUsed}</td>
        </tr>`;
      });
      table.innerHTML = html;
    }

    function restartQuiz() {
      document.getElementById('results-container').style.display = 'none';
      document.getElementById('quiz-container').style.display = 'block';
      resetMode();
    }

    function printResults() { window.print(); }

    function reviewAnswers() {
      // Create a review modal or scroll to detailed results
      alert('Review functionality: Study the detailed results table below to understand your performance in each category.');
    }

    document.addEventListener('DOMContentLoaded', function() {
      // Ensure all elements are available before setting up event listeners
      console.log('DOM loaded, initializing quiz...');
      
      document.getElementById('next-btn').addEventListener('click', nextQuestion);
      document.getElementById('back-btn').addEventListener('click', backQuestion);
      document.getElementById('restart-btn').addEventListener('click', restartQuiz);
      document.getElementById('print-btn').addEventListener('click', printResults);
      
      // Add click event listeners as fallback for mode selection
      document.addEventListener('click', function(event) {
        if (event.target.closest('[onclick*="selectMode"]')) {
          console.log('Click detected on mode selection element');
          const element = event.target.closest('[onclick*="selectMode"]');
          const onclickAttr = element.getAttribute('onclick');
          console.log('onclick attribute:', onclickAttr);
          
          if (onclickAttr.includes("selectMode('study')")) {
            console.log('Study mode clicked');
            selectMode('study');
          } else if (onclickAttr.includes("selectMode('quiz')")) {
            console.log('Quiz mode clicked');
            selectMode('quiz');
          }
        }
      });
      
      // Add direct event listeners to mode cards
      const studyModeCard = document.getElementById('study-mode-card');
      const quizModeCard = document.getElementById('quiz-mode-card');
      
      if (studyModeCard) {
        studyModeCard.addEventListener('click', function(e) {
          console.log('Study mode card clicked directly');
          e.preventDefault();
          selectMode('study');
        });
      }
      
      if (quizModeCard) {
        quizModeCard.addEventListener('click', function(e) {
          console.log('Quiz mode card clicked directly');
          e.preventDefault();
          selectMode('quiz');
        });
      }
      
      // Mode selection event handlers (keeping for backward compatibility)
      // document.getElementById('study-mode-btn').addEventListener('click', function() {
      //   console.log('Study mode selected');
      //   setMode('study');
      //   startQuiz();
      // });
      
      // document.getElementById('quiz-mode-btn').addEventListener('click', function() {
      //   console.log('Quiz mode selected');
      //   setMode('quiz');
      //   startQuiz();
      // });
      
      document.getElementById('reset-mode-btn').addEventListener('click', function() {
        console.log('Reset mode clicked');
        resetMode();
      });
      
      // Hint system event handler
      document.getElementById('hint-btn').addEventListener('click', function() {
        if (currentMode === 'study' || hintsRemaining > 0) {
          const hint = generateHint(quizData[currentQuestion]);
          document.getElementById('hint-text').textContent = hint;
          document.getElementById('hint-text').classList.remove('hidden');
          
          if (currentMode === 'quiz') {
            hintsRemaining--;
            hintsUsed.push(currentQuestion);
            
            // Update hint button
            this.disabled = true;
            this.textContent = 'Hint Used';
            this.classList.add('opacity-50', 'cursor-not-allowed');
            
            // Update hints remaining display
            document.getElementById('hints-remaining').textContent = `üí° Hints: ${hintsRemaining}`;
          } else {
            // In study mode, allow multiple hint uses
            this.textContent = 'Hide Hint';
            this.onclick = function() {
              document.getElementById('hint-text').classList.add('hidden');
              this.textContent = 'üí° Use Hint';
              this.onclick = null;
            };
          }
        }
      });
      
      // Add new event handlers
      document.getElementById('review-btn').addEventListener('click', reviewAnswers);
      document.getElementById('show-explanation-btn').addEventListener('click', function() {
        const explanationEl = document.getElementById('explanation');
        explanationEl.classList.toggle('hidden');
        this.textContent = explanationEl.classList.contains('hidden') ? 'Show Explanation' : 'Hide Explanation';
      });
      
      // Initialize with mode selection
      console.log('Initializing with mode selection...');
      console.log('DOM elements check:');
      console.log('mode-selection:', document.getElementById('mode-selection'));
      console.log('quiz-content:', document.getElementById('quiz-content'));
      
      // Test if onclick works
      console.log('Testing selectMode function availability:', typeof window.selectMode);
      
      resetMode();
    });
  </script>
</body>
</html>
