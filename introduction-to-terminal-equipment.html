<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Introduction to Terminal Equipment</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      background: white;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    /* Dark mode styles */
    @media (prefers-color-scheme: dark) {
      body {
        background: #0f172a;
        color: #f8fafc;
      }
    }
    
    .container {
      background: rgba(255, 255, 255, 0.98);
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      border-radius: 20px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }

    @media (prefers-color-scheme: dark) {
      .container {
        background: rgba(15, 23, 42, 0.95);
        border: 1px solid rgba(71, 85, 105, 0.3);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      }
    }
    
    .progress-container {
      background: #f1f5f9;
      height: 8px;
      border-radius: 4px;
      margin-bottom: 2rem;
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #10b981, #059669);
      border-radius: 4px;
      transition: width 0.4s ease;
      box-shadow: 0 2px 10px rgba(16, 185, 129, 0.3);
    }
    
    .results-table {
      width: 100%;
      border-collapse: collapse;
      margin: 0 auto;
    }
    
    .quiz-option {
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 16px 20px;
      margin: 8px 0;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      display: block;
      width: 100%;
    }
    
    #options-form {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    .quiz-option:hover {
      border-color: #10b981;
      background: rgba(16, 185, 129, 0.05);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.15);
    }
    
    .quiz-option.selected {
      border-color: #10b981;
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05));
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.2);
    }
    
    .quiz-option input[type="radio"] {
      appearance: none;
      width: 20px;
      height: 20px;
      border: 2px solid #cbd5e1;
      border-radius: 50%;
      margin-right: 12px;
      position: relative;
      transition: all 0.3s ease;
      vertical-align: middle;
    }
    
    .quiz-option input[type="radio"]:checked {
      border-color: #10b981;
      background: #10b981;
    }
    
    .quiz-option input[type="radio"]:checked::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: white;
    }
    
    .results-table th, .results-table td {
      padding: 16px 12px;
      text-align: center;
      border-bottom: 1px solid #e5e7eb;
      vertical-align: middle;
    }
    
    .results-table th {
      background: linear-gradient(135deg, #f8fafc, #f1f5f9);
      font-weight: 600;
      color: #374151;
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .results-table tr:hover {
      background-color: #f9fafb;
    }
    
    .results-table td:first-child {
      text-align: left;
      max-width: 300px;
      word-wrap: break-word;
    }
    
    .correct { 
      color: #059669; 
      font-weight: 600;
      background-color: #d1fae5;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.875rem;
    }
    
    .incorrect { 
      color: #dc2626; 
      font-weight: 600;
      background-color: #fee2e2;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.875rem;
    }
    
    /* Comprehensive dark mode styles for all elements */
    @media (prefers-color-scheme: dark) {
      .progress-container {
        background: #1e293b;
      }
      
      .quiz-option {
        background: rgba(30, 41, 59, 0.9);
        border: 2px solid #475569;
        color: #f1f5f9 !important;
      }
      
      .quiz-option:hover {
        border-color: #10b981;
        background: rgba(16, 185, 129, 0.15);
        color: #f8fafc !important;
      }
      
      .quiz-option.selected {
        border-color: #10b981;
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.25), rgba(5, 150, 105, 0.15));
        color: #f8fafc !important;
      }
      
      .quiz-option input[type="radio"] {
        border-color: #64748b;
      }
      
      .results-table th {
        background: linear-gradient(135deg, #1e293b, #334155);
        color: #f8fafc !important;
        border-bottom: 1px solid #475569;
      }
      
      .results-table th, .results-table td {
        border-bottom: 1px solid #475569;
        color: #f8fafc !important;
      }
      
      .results-table tr:hover {
        background-color: #1e293b;
      }
      
      .correct {
        color: #22c55e !important;
        background-color: rgba(34, 197, 94, 0.2);
      }
      
      .incorrect {
        color: #ef4444 !important;
        background-color: rgba(239, 68, 68, 0.2);
      }
      
      /* Force all text elements to be light colored */
      h1, h2, h3, h4, h5, h6 {
        color: #f8fafc !important;
      }
      
      p, div, span, label {
        color: #e2e8f0 !important;
      }
      
      /* Specific overrides for Tailwind classes */
      .text-gray-600, .text-gray-700, .text-gray-800 {
        color: #e2e8f0 !important;
      }
      
      .text-green-600, .text-green-700, .text-green-800 {
        color: #22c55e !important;
      }
      
      .text-blue-600, .text-blue-700, .text-blue-800 {
        color: #60a5fa !important;
      }
      
      .text-yellow-600 {
        color: #fbbf24 !important;
      }
      
      .text-red-600 {
        color: #ef4444 !important;
      }
      
      /* Question and category elements */
      #question-text, #question-number, #question-category {
        color: #f8fafc !important;
      }
      
      /* Mode selection cards */
      .bg-gradient-to-br {
        background: rgba(30, 41, 59, 0.9) !important;
        border-color: #475569 !important;
      }
      
      .bg-gradient-to-br h3 {
        color: #f8fafc !important;
      }
      
      .bg-gradient-to-br p {
        color: #e2e8f0 !important;
      }
      
      /* Hint section */
      .hint-section, #hint-section {
        background: rgba(30, 41, 59, 0.9) !important;
        border: 1px solid #475569;
        color: #f8fafc !important;
      }
      
      .hint-content, #hint-text {
        color: #e2e8f0 !important;
        background: rgba(30, 41, 59, 0.9) !important;
      }
      
      /* Feedback section */
      #feedback, #explanation {
        color: #e2e8f0 !important;
        background: rgba(30, 41, 59, 0.9) !important;
      }
      
      #answer-feedback {
        color: #f8fafc !important;
      }
      
      /* Buttons */
      button {
        color: white !important;
      }
      
      button:disabled {
        background: #374151 !important;
        color: #9ca3af !important;
      }
      
      /* Category badge styling */
      .quiz-category, #question-category {
        background: #1e40af !important;
        color: #dbeafe !important;
      }
      
      /* Question counter styling */
      .question-counter {
        color: #cbd5e1 !important;
      }
      
      /* Score display */
      #current-score, #final-score {
        color: #22c55e !important;
      }
      
      /* Results summary */
      #performance-summary {
        color: #f8fafc !important;
      }
      
      #performance-message {
        color: #e2e8f0 !important;
      }
      
      /* Stats and hints */
      .quiz-stats, #hints-remaining {
        color: #e2e8f0 !important;
      }
      
      /* Background colors for various sections */
      .bg-yellow-50, .bg-gray-50, .bg-blue-50, .bg-green-50 {
        background: rgba(30, 41, 59, 0.9) !important;
      }
      
      .bg-blue-100, .bg-green-100, .bg-yellow-100 {
        background: rgba(30, 41, 59, 0.9) !important;
      }
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .container {
        margin: 10px;
        padding: 1.5rem !important;
      }
      
      .quiz-option {
        padding: 12px 16px;
        font-size: 0.95rem;
      }
      
      .results-table th, .results-table td {
        padding: 12px 8px;
        font-size: 0.875rem;
      }
      
      .results-table td:first-child {
        max-width: 200px;
      }
    }
    
    @media print {
      body {
        background: white !important;
        padding: 0;
      }
      .container {
        background: white !important;
        box-shadow: none !important;
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
      }
      #results-container button {
        display: none !important;
      }
      .results-table {
        width: 100% !important;
        border-collapse: collapse !important;
      }
      .results-table th, .results-table td {
        border: 1px solid #ddd !important;
        font-size: 12px !important;
        padding: 8px 4px !important;
      }
    }
  </style>
</head>
<body>
  <div id="quiz-container" class="container p-8 rounded-xl shadow-xl">
    <div class="flex justify-between items-center mb-6">
      <a href="index.html" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 font-medium text-sm">
        ← Back to Menu
      </a>
      <h1 class="text-3xl font-bold text-gray-800 flex-1 text-center">Introduction to Terminal Equipment</h1>
      <div class="w-24"></div> <!-- Spacer for centering -->
    </div>
    
    <!-- Mode Selection -->
    <div id="mode-selection" class="mb-6 text-center">
      <p class="text-lg text-gray-600 mb-6">Choose your learning mode:</p>
      <div class="flex flex-col md:flex-row gap-6 justify-center">
        <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl border-2 border-blue-200 hover:border-blue-400 transition-all duration-300 cursor-pointer transform hover:scale-105" onclick="selectMode('study')">
          <div class="text-blue-600 mb-4">
            <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold text-blue-800 mb-2">Study Mode</h3>
          <p class="text-blue-700">Learn with immediate feedback, hints, and explanations. Perfect for understanding new concepts.</p>
        </div>
        <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl border-2 border-green-200 hover:border-green-400 transition-all duration-300 cursor-pointer transform hover:scale-105" onclick="selectMode('quiz')">
          <div class="text-green-600 mb-4">
            <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold text-green-800 mb-2">Quiz Mode</h3>
          <p class="text-green-700">Test your knowledge with limited hints available. Get detailed results at the end to review your performance.</p>
        </div>
      </div>
    </div>
    
    <!-- Quiz Content (initially hidden) -->
    <div id="quiz-content" style="display: none;">
      <!-- Mode Indicator -->
      <div class="flex justify-between items-center mb-4">
        <div id="mode-indicator" class="px-3 py-1 rounded-full text-sm font-medium"></div>
        <div class="flex items-center gap-2">
          <span id="hints-remaining" class="text-sm text-gray-600"></span>
          <button id="reset-mode-btn" class="px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors text-sm">
            Change Mode
          </button>
        </div>
      </div>
    
    <!-- Enhanced Progress Section -->
    <div class="mb-6">
      <!-- Progress Bar -->
      <div class="progress-container">
        <div id="progress-bar" class="progress-bar" style="width: 0%"></div>
      </div>
      
      <!-- Quiz Stats -->
      <div class="flex justify-between items-center mt-3 text-sm text-gray-600">
        <div class="quiz-stats">
          <span id="question-category" class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium"></span>
        </div>
        <div class="score-display" style="display: none;">
          Correct: <span id="current-score" class="font-bold text-green-600">0</span> / 
          <span id="total-questions">25</span>
        </div>
      </div>
    </div>
    
    <div id="question-number" class="text-lg text-gray-600 mb-3 text-center font-medium"></div>
    <div id="question-text" class="text-xl mb-6 text-center leading-relaxed text-gray-700 font-medium"></div>
    <form id="options-form"></form>
    
    <!-- Hint System -->
    <div id="hint-section" class="mt-4 text-center" style="display: none;">
      <button id="hint-btn" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors duration-200 font-medium">
        💡 Use Hint
      </button>
      <div id="hint-text" class="mt-2 text-sm text-gray-600 bg-yellow-50 p-3 rounded-lg hidden"></div>
    </div>
    
    <!-- Feedback Section -->
    <div id="feedback" class="mt-6 text-center">
      <div id="answer-feedback" class="mb-4"></div>
      <div id="explanation" class="text-sm text-gray-600 bg-gray-50 p-4 rounded-lg hidden"></div>
    </div>
    
    <div class="flex justify-center gap-4 mt-8">
      <button id="back-btn" class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200 font-medium min-w-[100px] disabled:opacity-50 disabled:cursor-not-allowed">Back</button>
      <button id="show-explanation-btn" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium min-w-[140px] hidden">Show Explanation</button>
      <button id="next-btn" class="px-6 py-3 bg-green-700 text-white rounded-lg hover:bg-green-800 transition-colors duration-200 font-medium min-w-[100px] shadow-lg hover:shadow-xl">Next</button>
    </div>
    </div> <!-- End quiz-content -->
  </div>
  <div id="results-container" class="container p-8 rounded-xl shadow-xl" style="display:none;">
    <div class="flex justify-between items-center mb-6">
      <a href="index.html" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 font-medium text-sm">
        ← Back to Menu
      </a>
      <h1 class="text-3xl font-bold text-gray-800 flex-1 text-center">Quiz Results</h1>
      <div class="w-24"></div> <!-- Spacer for centering -->
    </div>
    
    <!-- Score Card -->
    <div class="bg-gradient-to-br from-green-50 to-emerald-100 p-6 rounded-xl mb-8 border border-green-200">
      <div class="text-center">
        <p class="text-xl mb-2 text-gray-700 font-medium">Your Final Score</p>
        <p class="text-5xl font-bold text-green-700 mb-2"><span id="final-score"></span>/<span>25</span></p>
        <p class="text-xl text-green-600 font-semibold"><span id="percentage"></span>% Complete</p>
      </div>
    </div>
    
    <!-- Performance Summary -->
    <div class="text-center mb-8">
      <div id="performance-summary" class="text-3xl font-bold text-green-600 mb-4"></div>
      <p id="performance-message" class="text-gray-600 text-lg"></p>
    </div>
    
    <div class="overflow-x-auto">
      <table id="results-table" class="results-table"></table>
    </div>
    <div class="flex justify-center gap-4 mt-8">
      <button id="print-btn" class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200 font-medium min-w-[120px] shadow-lg hover:shadow-xl">📄 Print Results</button>
      <button id="restart-btn" class="px-6 py-3 bg-green-700 text-white rounded-lg hover:bg-green-800 transition-colors duration-200 font-medium min-w-[120px] shadow-lg hover:shadow-xl">🔄 Restart Quiz</button>
    </div>
  </div>
  <script>
    const quizData = [
      {
        question: "Which crane moves on wheels or rails and is used for stacking or loading/unloading containers in yards?",
        options: ["Gantry Crane", "Jib Crane", "Reach Stacker", "Automatic Guided Vehicle"],
        correct: "Gantry Crane"
      },
      {
        question: "What type of crane has a horizontal boom and is commonly used for loading/unloading ships?",
        options: ["Gantry Crane", "Jib Crane", "Reach Stacker", "Mobile Crane"],
        correct: "Jib Crane"
      },
      {
        question: "Which vehicle can lift and transport containers short distances, often used for stacking in yards?",
        options: ["Reach Stacker", "Gantry Crane", "Fork Lift", "Automatic Guided Vehicle"],
        correct: "Reach Stacker"
      },
      {
        question: "What type of vehicle operates without human intervention using pre-programmed routes?",
        options: ["Reach Stacker", "Fork Lift", "Automatic Guided Vehicle", "Terminal Tractor"],
        correct: "Automatic Guided Vehicle"
      },
      {
        question: "Which equipment is primarily used for lifting and moving palletized cargo?",
        options: ["Fork Lift", "Reach Stacker", "Gantry Crane", "Terminal Tractor"],
        correct: "Fork Lift"
      },
      {
        question: "What is the main purpose of a Terminal Tractor?",
        options: ["Lifting containers", "Towing trailers and equipment", "Stacking containers", "Loading ships"],
        correct: "Towing trailers and equipment"
      },
      {
        question: "Which crane type is typically mounted on rails and spans multiple container rows?",
        options: ["Rail-Mounted Gantry Crane", "Mobile Crane", "Jib Crane", "Reach Stacker"],
        correct: "Rail-Mounted Gantry Crane"
      },
      {
        question: "What equipment is used for transporting containers over medium distances within the terminal?",
        options: ["Straddle Carrier", "Fork Lift", "Jib Crane", "Terminal Tractor"],
        correct: "Straddle Carrier"
      },
      {
        question: "Which type of crane can move on rubber tires and is not fixed to rails?",
        options: ["Rubber-Tired Gantry Crane", "Rail-Mounted Gantry Crane", "Jib Crane", "Mobile Crane"],
        correct: "Rubber-Tired Gantry Crane"
      },
      {
        question: "What equipment combines the functions of lifting, transporting, and stacking containers?",
        options: ["Reach Stacker", "Fork Lift", "Terminal Tractor", "Automatic Guided Vehicle"],
        correct: "Reach Stacker"
      },
      {
        question: "Which crane type is ship-to-shore and used primarily for loading/unloading vessels?",
        options: ["Ship-to-Shore Crane", "Rail-Mounted Gantry Crane", "Rubber-Tired Gantry Crane", "Mobile Crane"],
        correct: "Ship-to-Shore Crane"
      },
      {
        question: "What is the primary advantage of Automatic Guided Vehicles in terminal operations?",
        options: ["Higher lifting capacity", "Reduced labor costs and improved safety", "Faster container movement", "Better fuel efficiency"],
        correct: "Reduced labor costs and improved safety"
      },
      {
        question: "Which equipment is best suited for handling break-bulk cargo on pallets?",
        options: ["Fork Lift", "Reach Stacker", "Gantry Crane", "Straddle Carrier"],
        correct: "Fork Lift"
      },
      {
        question: "What type of crane operates on a fixed track system and provides high precision?",
        options: ["Rail-Mounted Gantry Crane", "Mobile Crane", "Rubber-Tired Gantry Crane", "Reach Stacker"],
        correct: "Rail-Mounted Gantry Crane"
      },
      {
        question: "Which equipment can straddle and lift entire container rows?",
        options: ["Straddle Carrier", "Reach Stacker", "Fork Lift", "Terminal Tractor"],
        correct: "Straddle Carrier"
      },
      {
        question: "What is the key difference between a Rubber-Tired Gantry Crane and a Rail-Mounted Gantry Crane?",
        options: ["Lifting capacity", "Mobility and track dependency", "Operating speed", "Container handling method"],
        correct: "Mobility and track dependency"
      },
      {
        question: "Which equipment is most commonly used for horizontal transport of trailers within terminals?",
        options: ["Terminal Tractor", "Reach Stacker", "Fork Lift", "Straddle Carrier"],
        correct: "Terminal Tractor"
      },
      {
        question: "What type of crane has the highest lifting capacity in most terminal operations?",
        options: ["Ship-to-Shore Crane", "Mobile Crane", "Jib Crane", "Reach Stacker"],
        correct: "Ship-to-Shore Crane"
      },
      {
        question: "Which equipment provides the most flexibility for container yard operations?",
        options: ["Reach Stacker", "Rail-Mounted Gantry Crane", "Terminal Tractor", "Fork Lift"],
        correct: "Reach Stacker"
      },
      {
        question: "What is the primary limitation of Rail-Mounted Gantry Cranes compared to Rubber-Tired versions?",
        options: ["Lower lifting capacity", "Fixed movement paths", "Slower operation", "Higher maintenance costs"],
        correct: "Fixed movement paths"
      },
      {
        question: "Which equipment is essential for the automation of container terminal operations?",
        options: ["Automatic Guided Vehicle", "Manual Fork Lift", "Terminal Tractor", "Mobile Crane"],
        correct: "Automatic Guided Vehicle"
      },
      {
        question: "What type of equipment is best for accessing containers in tight spaces?",
        options: ["Reach Stacker", "Ship-to-Shore Crane", "Rail-Mounted Gantry Crane", "Straddle Carrier"],
        correct: "Reach Stacker"
      },
      {
        question: "Which crane type requires the most infrastructure investment?",
        options: ["Rail-Mounted Gantry Crane", "Mobile Crane", "Reach Stacker", "Fork Lift"],
        correct: "Rail-Mounted Gantry Crane"
      },
      {
        question: "What equipment is most suitable for moving containers between different yard blocks?",
        options: ["Straddle Carrier", "Fork Lift", "Jib Crane", "Terminal Tractor"],
        correct: "Straddle Carrier"
      },
      {
        question: "Which factor is most important when selecting terminal equipment for a new facility?",
        options: ["Equipment color", "Throughput requirements and operational efficiency", "Manufacturer preference", "Equipment age"],
        correct: "Throughput requirements and operational efficiency"
      }
    ];

    let currentQuestion = 0;
    let answers = [];
    let currentMode = 'study'; // 'study' or 'quiz'
    let score = 0;
    let currentScore = 0;
    let hintsRemaining = 3;
    let hintsUsed = 0;
    let hintsUsedInQuestions = {};

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function startQuiz() {
      currentScore = 0;
      shuffleArray(quizData);
      answers = new Array(quizData.length).fill(null);
      currentQuestion = 0;
      document.getElementById('current-score').textContent = currentScore;
      showQuestion();
    }

    function showQuestion() {
      const question = quizData[currentQuestion];
      const questionNumber = document.getElementById('question-number');
      const questionText = document.getElementById('question-text');
      const optionsForm = document.getElementById('options-form');
      
      questionNumber.textContent = `Question ${currentQuestion + 1} of ${quizData.length}`;
      questionText.textContent = question.question;
      
      // Set question category
      document.getElementById('question-category').textContent = 'Terminal Equipment';
      
      optionsForm.innerHTML = '';
      question.options.forEach((option, index) => {
        const label = document.createElement('label');
        label.className = 'quiz-option';
        label.innerHTML = `
          <input type="radio" name="answer" value="${option}">
          ${option}
        `;
        
        label.addEventListener('click', function() {
          document.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
          this.classList.add('selected');
          
          // In study mode, show explanation immediately
          if (currentMode === 'study') {
            const selectedValue = this.querySelector('input').value;
            const isCorrect = selectedValue === question.correct;
            
            // Store answer immediately for smooth navigation
            answers[currentQuestion] = selectedValue;
            
            // Calculate and update score
            calculateCurrentScore();
            
            // Immediate feedback without delay for smooth UI
            if (isCorrect) {
              document.getElementById('answer-feedback').innerHTML = '<div class="text-green-600 font-medium">✓ Correct!</div>';
            } else {
              document.getElementById('answer-feedback').innerHTML = '<div class="text-red-600 font-medium">✗ Incorrect</div>';
            }
            
            // Show explanation immediately without delay
            showExplanation();
          }
        });
        
        optionsForm.appendChild(label);
      });
      
      // Restore previous selection
      if (answers[currentQuestion]) {
        const selectedOption = document.querySelector(`input[value="${answers[currentQuestion]}"]`);
        if (selectedOption) {
          selectedOption.checked = true;
          selectedOption.closest('.quiz-option').classList.add('selected');
        }
      }
      
      updateProgress();
      updateButtons();
      clearFeedback();
      updateScoreDisplay();
    }

    function updateProgress() {
      const progress = ((currentQuestion + 1) / quizData.length) * 100;
      document.getElementById('progress-bar').style.width = `${progress}%`;
    }

    function updateScoreDisplay() {
      document.getElementById('current-score').textContent = currentScore;
      document.getElementById('total-questions').textContent = quizData.length;
    }

    function updateButtons() {
      const backBtn = document.getElementById('back-btn');
      const nextBtn = document.getElementById('next-btn');
      
      backBtn.disabled = currentQuestion === 0;
      nextBtn.textContent = currentQuestion === quizData.length - 1 ? 'Finish' : 'Next';
    }

    function clearFeedback() {
      // Don't clear feedback in study mode if there's already an answer
      if (currentMode === 'study' && answers[currentQuestion]) {
        return;
      }
      document.getElementById('answer-feedback').innerHTML = '';
      document.getElementById('explanation').classList.add('hidden');
    }

    document.getElementById('back-btn').addEventListener('click', function() {
      if (currentQuestion > 0) {
        currentQuestion--;
        showQuestion();
      }
    });

    document.getElementById('next-btn').addEventListener('click', function() {
      const selectedAnswer = document.querySelector('input[name="answer"]:checked');
      
      if (!selectedAnswer) {
        document.getElementById('answer-feedback').innerHTML = '<div class="text-red-600 font-medium">Please select an answer!</div>';
        return;
      }
      
      const selectedValue = selectedAnswer.value;
      const currentQ = quizData[currentQuestion];
      const isCorrect = selectedValue === currentQ.correct;
      
      // In quiz mode, show feedback and explanation button
      if (currentMode === 'quiz') {
        // Store the answer and calculate score
        answers[currentQuestion] = selectedValue;
        calculateCurrentScore();
        
        if (isCorrect) {
          document.getElementById('answer-feedback').innerHTML = '<div class="text-green-600 font-medium">✓ Correct!</div>';
        } else {
          document.getElementById('answer-feedback').innerHTML = '<div class="text-red-600 font-medium">✗ Incorrect</div>';
        }
        
        // Show explanation button in quiz mode
        document.getElementById('show-explanation-btn').classList.remove('hidden');
      }
      
      // Store the answer after score calculation
      answers[currentQuestion] = selectedValue;
      
      // Move to next question or show results
      if (currentQuestion < quizData.length - 1) {
        currentQuestion++;
        showQuestion();
      } else {
        showResults();
      }
    });

    function showResults() {
      document.getElementById('quiz-container').style.display = 'none';
      document.getElementById('results-container').style.display = 'block';
      
      // Calculate final score
      let finalScore = 0;
      const resultsTable = document.getElementById('results-table');
      
      // Add hint usage column if in quiz mode
      let tableHeaders = `
        <tr>
          <th>Question</th>
          <th>Your Answer</th>
          <th>Correct Answer</th>
          <th>Status</th>
          ${currentMode === 'quiz' ? '<th>Hint Used</th>' : ''}
        </tr>
      `;
      resultsTable.innerHTML = tableHeaders;
      
      quizData.forEach((question, index) => {
        const userAnswer = answers[index] || 'Not answered';
        const isCorrect = userAnswer === question.correct;
        
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${question.question}</td>
          <td>${userAnswer}</td>
          <td>${question.correct}</td>
          <td><span class="${isCorrect ? 'correct' : 'incorrect'}">${isCorrect ? 'Correct' : 'Incorrect'}</span></td>
          ${currentMode === 'quiz' ? `<td>${hintsUsedInQuestions[index] ? 'Yes' : 'No'}</td>` : ''}
        `;
        resultsTable.appendChild(row);
      });
      
      document.getElementById('final-score').textContent = finalScore;
      document.getElementById('percentage').textContent = Math.round((finalScore / quizData.length) * 100);
      
      // Add performance summary
      const performanceEl = document.getElementById('performance-summary');
      const percentage = Math.round((finalScore / quizData.length) * 100);
      const messageEl = document.getElementById('performance-message');
      
      let modeBonus = currentMode === 'study' ? ' (Study Mode)' : '';
      let hintPenalty = currentMode === 'quiz' && hintsUsed > 0 ? ` (${hintsUsed} hint${hintsUsed > 1 ? 's' : ''} used)` : '';
      
      if (percentage >= 90) {
        performanceEl.textContent = 'Outstanding! 🌟';
        performanceEl.className = 'text-3xl font-bold text-green-600 mb-4';
        messageEl.textContent = 'Excellent mastery of terminal equipment concepts!' + modeBonus + hintPenalty;
      } else if (percentage >= 80) {
        performanceEl.textContent = 'Great Job! 👍';
        performanceEl.className = 'text-3xl font-bold text-green-600 mb-4';
        messageEl.textContent = 'Strong understanding of terminal equipment!' + modeBonus + hintPenalty;
      } else if (percentage >= 70) {
        performanceEl.textContent = 'Good Work! 📈';
        performanceEl.className = 'text-3xl font-bold text-yellow-600 mb-4';
        messageEl.textContent = 'Solid foundation, review missed topics for improvement.' + modeBonus + hintPenalty;
      } else {
        performanceEl.textContent = 'Keep Learning! 📚';
        performanceEl.className = 'text-3xl font-bold text-orange-600 mb-4';
        messageEl.textContent = 'Additional study recommended. Try Study Mode to learn without pressure.' + hintPenalty;
      }
    }

    document.getElementById('print-btn').addEventListener('click', function() {
      window.print();
    });

    document.getElementById('restart-btn').addEventListener('click', function() {
      document.getElementById('results-container').style.display = 'none';
      document.getElementById('quiz-container').style.display = 'block';
      initializeQuiz();
    });

    // Mode selection function
    function selectMode(mode) {
      currentMode = mode;
      startQuiz();
    }

    // Mode selection event handlers (keeping for backward compatibility)
    // document.getElementById('study-mode-btn').addEventListener('click', function() {
    //   currentMode = 'study';
    //   startQuiz();
    // });

    // document.getElementById('quiz-mode-btn').addEventListener('click', function() {
    //   currentMode = 'quiz';
    //   startQuiz();
    // });

    document.getElementById('reset-mode-btn').addEventListener('click', function() {
      initializeQuiz();
    });

    // Hint system event handlers
    document.getElementById('hint-btn').addEventListener('click', function() {
      const hintText = document.getElementById('hint-text');
      const hintBtn = document.getElementById('hint-btn');
      
      if (hintText.classList.contains('hidden')) {
        showHint();
        hintText.classList.remove('hidden');
        hintBtn.textContent = 'Hide Hint';
        if (currentMode === 'quiz') {
          hintsUsed++;
          hintsUsedInQuestions[currentQuestion] = true;
        }
      } else {
        hintText.classList.add('hidden');
        hintBtn.textContent = '💡 Use Hint';
      }
    });

    document.getElementById('show-explanation-btn').addEventListener('click', function() {
      showExplanation();
    });

    function initializeQuiz() {
      // Reset all variables
      currentQuestion = 0;
      answers = [];
      score = 0;
      hintsRemaining = 3;
      hintsUsed = 0;
      hintsUsedInQuestions = {};
      
      // Show mode selection, hide quiz content
      document.getElementById('mode-selection').style.display = 'block';
      document.getElementById('quiz-content').style.display = 'none';
    }

    function startQuiz() {
      // Hide mode selection, show quiz content
      document.getElementById('mode-selection').style.display = 'none';
      document.getElementById('quiz-content').style.display = 'block';
      
      // Update mode indicator
      const modeIndicator = document.getElementById('mode-indicator');
      if (currentMode === 'study') {
        modeIndicator.textContent = '📚 Study Mode';
        modeIndicator.className = 'px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-700';
      } else {
        modeIndicator.textContent = '🎯 Quiz Mode';
        modeIndicator.className = 'px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-700';
      }
      
      // Update hint display
      updateHintDisplay();
      
      // Shuffle and start quiz
      shuffleArray(quizData);
      answers = new Array(quizData.length).fill(null);
      currentQuestion = 0;
      showQuestion();
    }

    function updateHintDisplay() {
      const hintsEl = document.getElementById('hints-remaining');
      const hintBtn = document.getElementById('hint-btn');
      
      if (currentMode === 'quiz') {
        hintsEl.textContent = `Hints: ${hintsRemaining}`;
        document.getElementById('hint-section').style.display = 'block';
        hintBtn.disabled = false;
        hintBtn.textContent = '💡 Use Hint';
        hintBtn.classList.remove('opacity-50', 'cursor-not-allowed');
      } else {
        hintsEl.textContent = '';
        document.getElementById('hint-section').style.display = 'block'; // Show hints in study mode too
        hintBtn.disabled = false;
        hintBtn.textContent = '💡 Use Hint';
        hintBtn.classList.remove('opacity-50', 'cursor-not-allowed');
      }
    }

    function showHint() {
      const hintBtn = document.getElementById('hint-btn');
      const hintText = document.getElementById('hint-text');
      const currentQ = quizData[currentQuestion];
      
      // Generate specific contextual hints based on question content
      let hint = '';
      const questionLower = currentQ.question.toLowerCase();
      
      if (questionLower.includes('rubber tyred gantry') || questionLower.includes('rtg')) {
        hint = '🏗️ RTG cranes run on rubber tires and can move between container rows. They typically stack containers 1-over-6 high and can span 6-8 container rows. They\'re diesel-powered and very mobile.';
      } else if (questionLower.includes('rail mounted gantry') || questionLower.includes('rmg')) {
        hint = '🚄 RMG cranes run on fixed rails and are usually automated. They can stack higher than RTGs (often 1-over-7) and cover larger areas but can\'t move between different yard blocks.';
      } else if (questionLower.includes('ship-to-shore') || questionLower.includes('quay crane')) {
        hint = '🚢 Ship-to-shore cranes are the tall cranes at the quay that load/unload ships. They run on rails along the wharf and have very long outreach to reach across wide container ships.';
      } else if (questionLower.includes('reach stacker')) {
        hint = '🚛 Reach stackers are wheeled vehicles that can pick up containers from the top using a telescopic spreader. They\'re very flexible and can stack containers 3-4 high and move around the terminal.';
      } else if (questionLower.includes('empty container handler') || questionLower.includes('ech')) {
        hint = '� Empty container handlers specialize in handling empty containers. They can pick up containers from the side and stack them very high (8-10 high) since empty containers are much lighter.';
      } else if (questionLower.includes('forklift')) {
        hint = '🏗️ Forklifts use forks to lift containers from underneath. They need special container handling attachments and are typically used for lighter containers or in smaller terminals.';
      } else if (questionLower.includes('terminal tractor') || questionLower.includes('yard truck')) {
        hint = '🚚 Terminal tractors (yard trucks) are specialized trucks used to move trailers and chassis around the terminal. They have fifth wheels for coupling to trailers and are very maneuverable.';
      } else if (questionLower.includes('mobile crane')) {
        hint = '🏗️ Mobile cranes are versatile wheeled cranes that can move around the terminal. They\'re often used for handling project cargo, maintenance work, or in smaller terminals where specialized equipment isn\'t cost-effective.';
      } else if (questionLower.includes('straddle carrier')) {
        hint = '🚛 Straddle carriers literally straddle containers - they drive over them and lift them from above. They can stack containers and move them around, combining the functions of crane and transport vehicle.';
      } else if (questionLower.includes('chassis') || questionLower.includes('trailer')) {
        hint = '� Chassis are wheeled trailers specifically designed to carry containers. They have twist locks to secure containers and come in different lengths (20ft, 40ft, 45ft) to match container sizes.';
      } else if (questionLower.includes('spreader')) {
        hint = '🔗 Spreaders are the lifting frames that attach to containers. They have twist locks that engage with the container\'s corner castings and can extend/retract to handle different container sizes.';
      } else if (questionLower.includes('reefer') || questionLower.includes('refrigerated')) {
        hint = '❄️ Reefer equipment includes power outlets, monitoring systems, and pre-trip inspection tools for refrigerated containers. Temperature and humidity must be constantly monitored and controlled.';
      } else if (questionLower.includes('safety') || questionLower.includes('hazard')) {
        hint = '⚠️ Terminal safety involves lockout/tagout procedures, personal protective equipment, safe working loads, proper communication protocols, and regular equipment inspections to prevent accidents.';
      } else if (questionLower.includes('capacity') || questionLower.includes('lifting')) {
        hint = '📏 Lifting capacity depends on the equipment type and configuration. Always check the safe working load (SWL) and never exceed it. Consider the weight of the container plus cargo when determining capacity.';
      } else if (questionLower.includes('maintenance')) {
        hint = '� Equipment maintenance includes daily inspections, preventive maintenance schedules, lubrication, hydraulic system checks, and keeping detailed maintenance records to ensure safe operation.';
      } else {
        hint = '💡 Think about the specific operational characteristics, capabilities, and primary use case of each piece of terminal equipment.';
      }
      
      hintText.textContent = hint;
      // Don't automatically show/hide or disable the button here - let the event handler control it
    }

    function clearFeedback() {
      document.getElementById('answer-feedback').textContent = '';
      document.getElementById('explanation').classList.add('hidden');
      document.getElementById('show-explanation-btn').classList.add('hidden');
      document.getElementById('hint-text').classList.add('hidden');
      
      // Reset hint button for new question
      const hintBtn = document.getElementById('hint-btn');
      hintBtn.disabled = false;
      hintBtn.textContent = '💡 Use Hint';
      hintBtn.classList.remove('opacity-50');
    }

    function showExplanation() {
      const explanation = document.getElementById('explanation');
      const currentQ = quizData[currentQuestion];
      
      // Generate explanation based on the correct answer
      let explanationText = '';
      if (currentQ.correct === 'Gantry Crane') {
        explanationText = 'Gantry cranes are large, powerful cranes that move on rails or wheels and are essential for container yard operations, providing high stacking capacity and efficient container handling.';
      } else if (currentQ.correct === 'Reach Stacker') {
        explanationText = 'Reach stackers are versatile mobile equipment that can lift, transport, and stack containers in yards, offering flexibility for container positioning and short-distance transport.';
      } else if (currentQ.correct === 'Automatic Guided Vehicle') {
        explanationText = 'AGVs operate autonomously using pre-programmed routes and navigation systems, increasing efficiency and reducing human error in container transport operations.';
      } else if (currentQ.correct === 'Fork Lift') {
        explanationText = 'Forklifts are essential for handling palletized cargo and smaller loads, providing precision lifting and maneuverability in warehouse operations.';
      } else {
        explanationText = `The correct answer is "${currentQ.correct}". This equipment plays a crucial role in terminal operations with specific operational advantages.`;
      }
      
      explanation.textContent = explanationText;
      explanation.classList.remove('hidden');
      document.getElementById('show-explanation-btn').classList.add('hidden');
    }

    function calculateCurrentScore() {
      let score = 0;
      for (let i = 0; i < answers.length; i++) {
        if (answers[i] === quizData[i].correct) {
          score++;
        }
      }
      currentScore = score;
      document.getElementById('current-score').textContent = currentScore;
    }

    // Initialize the quiz
    initializeQuiz();
  </script>
</body>
</html>
